{"version":3,"file":"v-click-outside.min.min.umd.js","sources":["../lib/v-click-outside.js","../lib/index.js"],"sourcesContent":["const HAS_WINDOWS = typeof window !== 'undefined'\nconst HAS_NAVIGATOR = typeof navigator !== 'undefined'\nconst IS_TOUCH =\n  HAS_WINDOWS && ('ontouchstart' in window || (HAS_NAVIGATOR && navigator.msMaxTouchPoints > 0))\nconst EVENTS = IS_TOUCH ? ['touchstart'] : ['click']\nconst IDENTITY = (item) => item\n\nconst directive = {\n  instances: [],\n}\n\nfunction processDirectiveArguments(bindingValue) {\n  const isFunction = typeof bindingValue === 'function'\n  if (!isFunction && typeof bindingValue !== 'object') {\n    throw new Error('v-click-outside: Binding value must be a function or an object')\n  }\n\n  return {\n    handler: isFunction ? bindingValue : bindingValue.handler,\n    middleware: bindingValue.middleware || IDENTITY,\n    events: bindingValue.events || EVENTS,\n    isActive: !(bindingValue.isActive === false),\n  }\n}\n\nfunction onEvent({ el, event, handler, middleware }) {\n  const isClickOutside = event.target !== el && !el.contains(event.target)\n\n  if (!isClickOutside) {\n    return\n  }\n\n  if (middleware(event, el)) {\n    handler(event, el)\n  }\n}\n\nfunction createInstance({ el, events, handler, middleware }) {\n  return {\n    el,\n    eventHandlers: events.map((eventName) => ({\n      event: eventName,\n      handler: (event) => onEvent({ event, el, handler, middleware }),\n    })),\n  }\n}\n\nfunction removeInstance(el) {\n  const instanceIndex = directive.instances.findIndex((instance) => instance.el === el)\n  if (instanceIndex === -1) {\n    // Note: This can happen when active status changes from false to false\n    return\n  }\n\n  const instance = directive.instances[instanceIndex]\n\n  instance.eventHandlers.forEach(({ event, handler }) =>\n    document.removeEventListener(event, handler),\n  )\n\n  directive.instances.splice(instanceIndex, 1)\n}\n\nfunction bind(el, { value }) {\n  const { events, handler, middleware, isActive } = processDirectiveArguments(value)\n\n  if (!isActive) {\n    return\n  }\n\n  const instance = createInstance({ el, events, handler, middleware })\n\n  instance.eventHandlers.forEach(({ event, handler }) =>\n    setTimeout(() => document.addEventListener(event, handler), 0),\n  )\n  directive.instances.push(instance)\n}\n\nfunction update(el, { value, oldValue }) {\n  if (JSON.stringify(value) === JSON.stringify(oldValue)) {\n    return\n  }\n\n  const { events, handler, middleware, isActive } = processDirectiveArguments(value)\n\n  if (!isActive) {\n    removeInstance(el)\n    return\n  }\n\n  let instance = directive.instances.find((instance) => instance.el === el)\n\n  if (instance) {\n    instance.eventHandlers.forEach(({ event, handler }) =>\n      document.removeEventListener(event, handler),\n    )\n    instance.eventHandlers = events.map((eventName) => ({\n      event: eventName,\n      handler: (event) => onEvent({ event, el, handler, middleware }),\n    }))\n  } else {\n    instance = createInstance({ el, events, handler, middleware })\n    directive.instances.push(instance)\n  }\n\n  instance.eventHandlers.forEach(({ event, handler }) =>\n    setTimeout(() => document.addEventListener(event, handler), 0),\n  )\n}\n\ndirective.bind = bind\ndirective.update = update\ndirective.unbind = removeInstance\n\nexport default directive\n","import directive from './v-click-outside'\n\nconst plugin = {\n  install(Vue) {\n    Vue.directive('click-outside', directive)\n  },\n  directive,\n}\n\nexport default plugin\n"],"names":["const","HAS_WINDOWS","window","HAS_NAVIGATOR","navigator","EVENTS","msMaxTouchPoints","IDENTITY","item","directive","instances","processDirectiveArguments","bindingValue","isFunction","Error","handler","middleware","events","isActive","onEvent","ref","event","target","el","contains","createInstance","eventHandlers","map","eventName","removeInstance","instanceIndex","findIndex","instance","forEach","document","removeEventListener","splice","bind","setTimeout","addEventListener","push","update","JSON","stringify","value","oldValue","find","unbind","install","Vue"],"mappings":"iLAAAA,IAAMC,EAAgC,oBAAXC,OACrBC,EAAqC,oBAAdC,UAGvBC,EADJJ,IAAgB,iBAAkBC,QAAWC,GAAiBC,UAAUE,iBAAmB,GACnE,CAAC,cAAgB,CAAC,SACtCC,WAAYC,UAASA,GAErBC,EAAY,CAChBC,UAAW,IAGb,SAASC,EAA0BC,OAC3BC,EAAqC,mBAAjBD,MACrBC,GAAsC,iBAAjBD,QAClB,IAAIE,MAAM,wEAGX,CACLC,QAASF,EAAaD,EAAeA,EAAaG,QAClDC,WAAYJ,EAAaI,YAAcT,EACvCU,OAAQL,EAAaK,QAAUZ,EAC/Ba,YAAsC,IAA1BN,EAAaM,WAI7B,SAASC,EAAQC,mDACQC,EAAMC,SAAWC,IAAOA,EAAGC,SAASH,EAAMC,SAM7DN,EAAWK,EAAOE,IACpBR,EAAQM,EAAOE,GAInB,SAASE,EAAeL,+CACf,IACLG,EACAG,uBAAsBC,aAAKC,UACzBP,MAAOO,EACPb,iBAAUM,UAAUF,EAAQ,OAAEE,KAAOE,UAAIR,aAASC,SAKxD,SAASa,EAAeN,OAChBO,EAAgBrB,EAAUC,UAAUqB,mBAAWC,UAAaA,EAAST,KAAOA,KAC3D,IAAnBO,IAKarB,EAAUC,UAAUoB,GAE5BJ,cAAcO,iBAASb,UAC9Bc,SAASC,yCAGX1B,EAAUC,UAAU0B,OAAON,EAAe,WAkD5CrB,EAAU4B,KA/CV,SAAcd,EAAIH,SACkCT,8BAM5CqB,EAAWP,EAAe,IAAEF,8DAElCS,EAASN,cAAcO,iBAASb,oCAC9BkB,6BAAiBJ,SAASK,iBAAiBlB,EAAON,IAAU,KAE9DN,EAAUC,UAAU8B,KAAKR,KAoC3BvB,EAAUgC,OAjCV,SAAgBlB,EAAIH,iCACdsB,KAAKC,UAAUC,KAAWF,KAAKC,UAAUE,UAIKlC,EAA0BiC,4DAOxEZ,EAAWvB,EAAUC,UAAUoC,cAAMd,UAAaA,EAAST,KAAOA,IAElES,GACFA,EAASN,cAAcO,iBAASb,UAC9Bc,SAASC,yCAEXH,EAASN,cAAgBT,EAAOU,aAAKC,UACnCP,MAAOO,EACPb,iBAAUM,UAAUF,EAAQ,OAAEE,KAAOE,UAAIR,aAASC,UAGpDgB,EAAWP,EAAe,IAAEF,SAAIN,UAAQF,aAASC,IACjDP,EAAUC,UAAU8B,KAAKR,IAG3BA,EAASN,cAAcO,iBAASb,oCAC9BkB,6BAAiBJ,SAASK,iBAAiBlB,EAAON,IAAU,UApB5Dc,EAAeN,KA0BnBd,EAAUsC,OAASlB,EC9GJ,CACbmB,iBAAQC,GACNA,EAAIxC,UAAU,gBAAiBA,cAEjCA"}