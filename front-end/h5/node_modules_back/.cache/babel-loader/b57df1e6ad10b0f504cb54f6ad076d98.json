{"remainingRequest":"d:\\project\\luban\\luban-h5\\front-end\\h5\\node_modules\\babel-loader\\lib\\index.js!d:\\project\\luban\\luban-h5\\front-end\\h5\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js??ref--13-0!d:\\project\\luban\\luban-h5\\front-end\\h5\\src\\components\\core\\editor\\index.js","dependencies":[{"path":"d:\\project\\luban\\luban-h5\\front-end\\h5\\src\\components\\core\\editor\\index.js","mtime":1575875817491},{"path":"d:\\project\\luban\\luban-h5\\front-end\\h5\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1575454486584},{"path":"d:\\project\\luban\\luban-h5\\front-end\\h5\\node_modules\\babel-loader\\lib\\index.js","mtime":1575361257763},{"path":"d:\\project\\luban\\luban-h5\\front-end\\h5\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js","mtime":1575454465101}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/es6.array.find\";\nimport \"core-js/modules/es6.function.name\";\nimport _defineProperty from \"d:\\\\project\\\\luban\\\\luban-h5\\\\front-end\\\\h5\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { mapState, mapActions } from 'vuex';\nimport undoRedoHistory from \"../../../store/plugins/undo-redo/History\";\nimport \"../styles/index.scss\";\nimport 'animate.css';\nimport RenderEditCanvas from \"./canvas/edit\";\nimport RenderPreviewCanvas from \"./canvas/preview\";\nimport RenderPropsEditor from \"./edit-panel/props\";\nimport RenderScriptEditor from \"./edit-panel/script\";\nimport RenderAnimationEditor from \"./edit-panel/animation\";\nimport RenderActoionEditor from \"./edit-panel/action\";\nimport RenderBackgroundEditor from \"./edit-panel/background\";\nimport RenderShortcutsPanel from \"./shortcuts-panel/index\";\nimport RenderPageManager from \"./page-manager/index\";\nimport PreviewDialog from \"./modals/preview.vue\";\nimport LogoOfHeader from '@/components/common/header/logo.js';\nimport ExternalLinksOfHeader from '@/components/common/header/links.js';\nimport LangSelect from '@/components/common/header/LangSelect.vue';\nimport Feedback from '@/components/common/feedback/index'; // const sidebarMenus = [\n//   {\n//     i18nLabel: 'editor.sidebar.components',\n//     label: '组件列表',\n//     value: 'pluginList',\n//     antIcon: 'bars'\n//   },\n//   {\n//     i18nLabel: 'editor.sidebar.pages',\n//     label: '页面管理',\n//     value: 'pageManagement',\n//     antIcon: 'snippets'\n//   },\n//   {\n//     i18nLabel: 'editor.sidebar.templates',\n//     label: '免费模板',\n//     value: 'freeTemplate',\n//     antIcon: 'appstore'\n//   }\n// ]\n\nvar fixedTools = [{\n  i18nTooltip: 'editor.fixedTool.undo',\n  'tooltip': '撤消',\n  // TODO 支持快捷键\n  'text': '撤消',\n  'icon': 'mail-reply',\n  'action': function action() {\n    return undoRedoHistory.undo();\n  }\n}, {\n  i18nTooltip: 'editor.fixedTool.redo',\n  'tooltip': '恢复',\n  'text': '恢复',\n  'icon': 'mail-forward',\n  'action': function action() {\n    return undoRedoHistory.redo();\n  }\n}, {\n  i18nTooltip: 'editor.fixedTool.preview',\n  'tooltip': '刷新预览',\n  'text': '刷新预览',\n  'icon': 'eye',\n  'action': function action() {\n    this.previewVisible = true;\n  }\n}, // {\n//   i18nTooltip: 'editor.fixedTool.copyCurrentPage',\n//   'tooltip': '复制当前页',\n//   'text': '复制当前页',\n//   'icon': 'copy',\n//   'action': function () { this.pageManager({ type: 'copy' }) }\n// },\n// {\n//   i18nTooltip: 'editor.fixedTool.importPSD',\n//   'tooltip': '导入PSD',\n//   'text': 'Ps',\n//   'icon': '',\n//   'action': '',\n//   'disabled': true\n// },\n{\n  i18nTooltip: 'editor.fixedTool.zoomOut',\n  'tooltip': '放大画布',\n  'text': '放大画布',\n  'icon': 'plus',\n  'action': function action() {\n    this.scaleRate += 0.25;\n  }\n}, {\n  i18nTooltip: 'editor.fixedTool.zoomIn',\n  'tooltip': '缩小画布',\n  'text': '缩小画布',\n  'icon': 'minus',\n  'action': function action() {\n    this.scaleRate -= 0.25;\n  }\n} // {\n//   i18nTooltip: 'editor.fixedTool.issues',\n//   'tooltip': 'issues',\n//   'text': '常见问题',\n//   'icon': 'question',\n//   'action': function () { window.open('https://github.com/ly525/luban-h5/issues/110') }\n// }\n];\nexport default {\n  name: 'Editor',\n  components: {\n    LogoOfHeader: LogoOfHeader,\n    ExternalLinksOfHeader: ExternalLinksOfHeader,\n    LangSelect: LangSelect\n  },\n  data: function data() {\n    return {\n      activeMenuKey: 'pluginList',\n      isPreviewMode: false,\n      activeTabKey: '属性',\n      previewVisible: false,\n      scaleRate: 1\n    };\n  },\n  computed: _objectSpread({}, mapState('editor', {\n    editingPage: function editingPage(state) {\n      return state.editingPage;\n    },\n    editingElement: function editingElement(state) {\n      return state.editingElement;\n    },\n    elements: function elements(state) {\n      return state.editingPage.elements;\n    },\n    pages: function pages(state) {\n      return state.work.pages;\n    },\n    work: function work(state) {\n      return state.work;\n    }\n  }), {}, mapState('loading', ['saveWork_loading', 'previewWork_loading', 'setWorkAsTemplate_loading', 'uploadWorkCover_loading'])),\n  methods: _objectSpread({}, mapActions('editor', ['elementManager', 'pageManager', 'saveWork', 'createWork', 'fetchWork', 'setWorkAsTemplate', 'setEditingElement', 'setEditingPage']), {}, mapActions('loading', {\n    updateLoading: 'update'\n  }), {\n    /**\r\n     * !#zh 点击插件，copy 其基础数据到组件树（中间画布）\r\n     * #!en click the plugin shortcut, create new Element with the plugin's meta data\r\n     * pluginInfo {Object}: 插件列表中的基础数据, {name}=pluginInfo\r\n     */\n    clone: function clone(_ref) {\n      var name = _ref.name;\n      this.elementManager({\n        type: 'add',\n        value: {\n          name: name\n        }\n      });\n    },\n    _renderMenuContent: function _renderMenuContent() {\n      var _this = this;\n\n      var h = this.$createElement;\n      return h(\"a-tabs\", {\n        \"style\": \"height: 100%;\",\n        \"attrs\": {\n          \"tabBarGutter\": 10\n        }\n      }, [h(\"a-tab-pane\", {\n        \"key\": \"plugin-list\",\n        \"attrs\": {\n          \"tab\": this.$t('editor.sidebar.components')\n        }\n      }, [h(\"div\", {\n        \"class\": \"plugin-usage-tip \"\n      }, [h(\"a-icon\", {\n        \"attrs\": {\n          \"type\": \"info-circle\"\n        }\n      }), h(\"i18n\", {\n        \"attrs\": {\n          \"path\": \"editor.tip.componentUsage\",\n          \"tag\": \"span\"\n        },\n        \"class\": \"ml-1\"\n      }, [h(\"strong\", [this.$t('editor.tip.click')]), this.$t('editor.tip.click')])]), h(RenderShortcutsPanel, {\n        \"attrs\": {\n          \"pluginsList\": this.pluginsList,\n          \"handleClickShortcut\": this.clone\n        }\n      })]), h(\"a-tab-pane\", {\n        \"key\": 'page-manager',\n        \"attrs\": {\n          \"tab\": this.$t('editor.sidebar.pages')\n        }\n      }, [h(RenderPageManager, {\n        \"attrs\": {\n          \"pages\": this.pages,\n          \"editingPage\": this.editingPage\n        },\n        \"on\": {\n          \"selectMenuItem\": function selectMenuItem(menuKey) {\n            _this.pageManager({\n              type: menuKey\n            });\n          },\n          \"editTitle\": function editTitle(_ref2) {\n            var pageIndexForEditingTitle = _ref2.pageIndexForEditingTitle,\n                newTitle = _ref2.newTitle;\n\n            _this.pageManager({\n              type: 'editTitle',\n              value: {\n                pageIndexForEditingTitle: pageIndexForEditingTitle,\n                newTitle: newTitle\n              }\n            });\n\n            _this.saveWork({\n              isSaveCover: false\n            });\n          },\n          \"selectPage\": function selectPage(pageIndex) {\n            _this.setEditingPage(pageIndex);\n          }\n        }\n      })])]); // switch (this.activeMenuKey) {\n      //   case sidebarMenus[0].value:\n      //     return (\n      //       <a-tabs\n      //         style=\"height: 100%;\"\n      //         tabBarGutter={10}\n      //       >\n      //         <a-tab-pane key=\"plugin-list\" tab={this.$t('editor.sidebar.components')}>\n      //           <RenderShortcutsPanel pluginsList={this.pluginsList} handleClickShortcut={this.clone} />\n      //         </a-tab-pane>\n      //         <a-tab-pane key='page-manager' tab={this.$t('editor.sidebar.pages')}>\n      //           <RenderPageManager\n      //             pages={this.pages}\n      //             editingPage={this.editingPage}\n      //             onSelectMenuItem={(menuKey) => {\n      //               this.pageManager({ type: menuKey })\n      //             }}\n      //             onEditTitle={({ pageIndexForEditingTitle, newTitle }) => {\n      //               this.pageManager({ type: 'editTitle', value: { pageIndexForEditingTitle, newTitle } })\n      //               this.saveWork({ isSaveCover: false })\n      //             }}\n      //             onSelectPage={(pageIndex) => { this.setEditingPage(pageIndex) }}\n      //           />\n      //         </a-tab-pane>\n      //       </a-tabs>\n      //     )\n      //   case sidebarMenus[1].value:\n      //     return (\n      //       <RenderPageManager\n      //         pages={this.pages}\n      //         editingPage={this.editingPage}\n      //         onSelectMenuItem={(menuKey) => {\n      //           this.pageManager({ type: menuKey })\n      //         }}\n      //         onSelectPage={(pageIndex) => { this.setEditingPage(pageIndex) }}\n      //       />\n      //     )\n      //   default:\n      //     return null\n      // }\n    }\n  }),\n  render: function render(h) {\n    var _this2 = this;\n\n    return h(\"a-layout\", {\n      \"attrs\": {\n        \"id\": \"luban-editor-layout\"\n      },\n      \"style\": {\n        height: '100vh'\n      }\n    }, [h(\"a-layout-header\", {\n      \"class\": \"header\"\n    }, [h(LogoOfHeader), h(LangSelect, {\n      \"style\": \"float: right;cursor: pointer;\"\n    }), h(\"a-menu\", {\n      \"attrs\": {\n        \"theme\": \"dark\",\n        \"mode\": \"horizontal\",\n        \"defaultSelectedKeys\": ['2']\n      },\n      \"style\": {\n        lineHeight: '64px',\n        float: 'right',\n        background: 'transparent'\n      }\n    }, [h(\"a-menu-item\", {\n      \"key\": \"1\",\n      \"class\": \"transparent-bg\"\n    }, [h(\"a-button\", {\n      \"attrs\": {\n        \"type\": \"primary\",\n        \"size\": \"small\",\n        \"loading\": this.previewWork_loading\n      },\n      \"on\": {\n        \"click\": function click() {\n          _this2.saveWork({\n            loadingName: 'previewWork_loading'\n          }).then(function () {\n            _this2.previewVisible = true;\n          });\n        }\n      }\n    }, [this.$t('editor.header.preview')])]), h(\"a-menu-item\", {\n      \"key\": \"2\",\n      \"class\": \"transparent-bg\"\n    }, [h(\"a-button\", {\n      \"attrs\": {\n        \"size\": \"small\",\n        \"loading\": this.saveWork_loading || this.uploadWorkCover_loading\n      },\n      \"on\": {\n        \"click\": function click() {\n          return _this2.saveWork({\n            isSaveCover: true\n          });\n        }\n      }\n    }, [this.$t('editor.header.save')])]), h(\"a-menu-item\", {\n      \"key\": \"3\",\n      \"class\": \"transparent-bg\"\n    }, [h(\"a-dropdown-button\", {\n      \"on\": {\n        \"click\": function click() {}\n      },\n      \"attrs\": {\n        \"size\": \"small\"\n      }\n    }, [this.$t('editor.header.publish'), h(\"a-menu\", {\n      \"slot\": \"overlay\",\n      \"on\": {\n        \"click\": function click(_ref3) {\n          var key = _ref3.key;\n\n          switch (key) {\n            case 'setAsTemplate':\n              _this2.updateLoading({\n                type: 'setWorkAsTemplate_loading',\n                value: true\n              });\n\n              _this2.saveWork().then(function () {\n                _this2.setWorkAsTemplate();\n              });\n\n          }\n        }\n      }\n    }, [h(\"a-menu-item\", {\n      \"key\": \"setAsTemplate\"\n    }, [h(\"a-spin\", {\n      \"attrs\": {\n        \"spinning\": this.setWorkAsTemplate_loading,\n        \"size\": \"small\"\n      }\n    }, [h(\"a-icon\", {\n      \"attrs\": {\n        \"type\": \"cloud-upload\"\n      }\n    }), this.$t('editor.header.setAsTemplate')])])])])])]), h(ExternalLinksOfHeader)]), h(\"a-layout\", [h(\"a-layout-sider\", {\n      \"attrs\": {\n        \"width\": \"240\",\n        \"theme\": 'light'\n      },\n      \"style\": {\n        background: '#fff',\n        padding: '12px'\n      }\n    }, [this._renderMenuContent()]), h(\"a-layout\", {\n      \"style\": \"padding: 0 0 24px\"\n    }, [h(\"a-layout-content\", {\n      \"style\": {\n        padding: '24px',\n        margin: 0,\n        minHeight: '280px'\n      }\n    }, [h(\"div\", {\n      \"style\": \"text-align: center;\"\n    }, [h(\"a-radio-group\", {\n      \"attrs\": {\n        \"size\": \"small\",\n        \"value\": this.isPreviewMode\n      },\n      \"on\": {\n        \"input\": function input(isPreviewMode) {\n          _this2.isPreviewMode = isPreviewMode;\n\n          if (isPreviewMode) {\n            // 当切换到预览模式的时候，清空当前编辑元素\n            _this2.setEditingElement(); // 相当于  setEditingElement(null)\n\n          }\n        }\n      }\n    }, [h(\"a-radio-button\", {\n      \"attrs\": {\n        \"label\": false,\n        \"value\": false\n      }\n    }, [this.$t('editor.centerPanel.mode.edit')]), h(\"a-radio-button\", {\n      \"attrs\": {\n        \"label\": true,\n        \"value\": true\n      }\n    }, [this.$t('editor.centerPanel.mode.preview')])])]), h(\"div\", {\n      \"class\": 'canvas-wrapper',\n      \"style\": {\n        transform: \"scale(\".concat(this.scaleRate, \")\")\n      }\n    }, [this.isPreviewMode ? h(RenderPreviewCanvas, {\n      \"attrs\": {\n        \"elements\": this.elements\n      }\n    }) : h(RenderEditCanvas, {\n      \"class\": \"edit-mode\",\n      \"attrs\": {\n        \"elements\": this.elements\n      }\n    })])])]), h(\"a-layout-sider\", {\n      \"attrs\": {\n        \"width\": \"40\",\n        \"theme\": 'light'\n      },\n      \"style\": {\n        background: '#fff',\n        border: '1px solid #eee'\n      }\n    }, [h(\"a-button-group\", {\n      \"style\": {\n        display: 'flex',\n        flexDirection: 'column'\n      }\n    }, [fixedTools.map(function (tool) {\n      return (// <a-tooltip effect=\"dark\" placement=\"left\" title={tool.tooltip}>\n        h(\"a-tooltip\", {\n          \"attrs\": {\n            \"effect\": \"dark\",\n            \"placement\": \"left\",\n            \"title\": _this2.$t(tool.i18nTooltip)\n          }\n        }, [h(\"a-button\", {\n          \"attrs\": {\n            \"block\": true,\n            \"type\": \"link\",\n            \"size\": \"small\",\n            \"disabled\": !!tool.disabled\n          },\n          \"class\": \"transparent-bg\",\n          \"style\": {\n            height: '40px',\n            color: '#000'\n          },\n          \"on\": {\n            \"click\": function click() {\n              return tool.action && tool.action.call(_this2);\n            }\n          }\n        }, [tool.icon ? h(\"i\", {\n          \"class\": ['shortcut-icon', 'fa', \"fa-\".concat(tool.icon)],\n          \"attrs\": {\n            \"aria-hidden\": 'true'\n          }\n        }) : tool.text]), tool.icon === 'minus' && h(\"div\", {\n          \"style\": {\n            fontSize: '12px',\n            textAlign: 'center'\n          }\n        }, [_this2.scaleRate * 100, \"%\"])])\n      );\n    })])]), h(\"a-layout-sider\", {\n      \"attrs\": {\n        \"width\": \"300\",\n        \"theme\": 'light'\n      },\n      \"style\": {\n        background: '#fff',\n        padding: '0 12px'\n      }\n    }, [h(\"a-tabs\", {\n      \"style\": \"height: 100%;\",\n      \"attrs\": {\n        \"tabBarGutter\": 10\n      },\n      \"on\": {\n        \"change\": function change(activeTabKey) {\n          _this2.activeTabKey = activeTabKey;\n\n          if (activeTabKey === 'background') {\n            var bgElement = _this2.elements.find(function (e) {\n              return e.name === 'lbp-background';\n            });\n\n            _this2.setEditingElement(bgElement);\n          }\n        }\n      }\n    }, [h(\"a-tab-pane\", {\n      \"key\": \"属性\"\n    }, [h(\"span\", {\n      \"slot\": \"tab\"\n    }, [this.$t('editor.editPanel.tab.prop')]), h(RenderPropsEditor)]), h(\"a-tab-pane\", {\n      \"attrs\": {\n        \"label\": \"动画\",\n        \"tab\": this.$t('editor.editPanel.tab.animation')\n      },\n      \"key\": '动画'\n    }, [h(RenderAnimationEditor)]), h(\"a-tab-pane\", {\n      \"attrs\": {\n        \"label\": \"动作\",\n        \"tab\": this.$t('editor.editPanel.tab.action')\n      },\n      \"key\": '动作'\n    }, [this.activeTabKey === '动作' && h(RenderActoionEditor)]), h(\"a-tab-pane\", {\n      \"attrs\": {\n        \"label\": \"脚本\",\n        \"tab\": this.$t('editor.editPanel.tab.script')\n      },\n      \"key\": '脚本'\n    }, [h(RenderScriptEditor)]), h(\"a-tab-pane\", {\n      \"attrs\": {\n        \"label\": \"背景\",\n        \"tab\": this.$t('editor.editPanel.tab.background')\n      },\n      \"key\": 'background'\n    }, [h(RenderBackgroundEditor)])])])]), h(PreviewDialog, {\n      \"attrs\": {\n        \"work\": this.work,\n        \"visible\": this.previewVisible,\n        \"handleClose\": function handleClose() {\n          _this2.previewVisible = false;\n        }\n      }\n    }), h(Feedback)]);\n  },\n  created: function created() {\n    // event bus for editor\n    window.getEditorApp = this;\n    var workId = this.$route.params.workId;\n\n    if (workId) {\n      this.fetchWork(workId);\n    } else {\n      this.$message.error('no work id!');\n    }\n  }\n};",{"version":3,"sources":["d:/project/luban/luban-h5/front-end/h5/src/components/core/editor/index.js"],"names":["mapState","mapActions","undoRedoHistory","RenderEditCanvas","RenderPreviewCanvas","RenderPropsEditor","RenderScriptEditor","RenderAnimationEditor","RenderActoionEditor","RenderBackgroundEditor","RenderShortcutsPanel","RenderPageManager","PreviewDialog","LogoOfHeader","ExternalLinksOfHeader","LangSelect","Feedback","fixedTools","i18nTooltip","undo","redo","previewVisible","scaleRate","name","components","data","activeMenuKey","isPreviewMode","activeTabKey","computed","editingPage","state","editingElement","elements","pages","work","methods","updateLoading","clone","elementManager","type","value","_renderMenuContent","$t","pluginsList","menuKey","pageManager","pageIndexForEditingTitle","newTitle","saveWork","isSaveCover","pageIndex","setEditingPage","render","h","height","lineHeight","float","background","previewWork_loading","loadingName","then","saveWork_loading","uploadWorkCover_loading","key","setWorkAsTemplate","setWorkAsTemplate_loading","padding","margin","minHeight","setEditingElement","transform","border","display","flexDirection","map","tool","disabled","color","action","call","icon","text","fontSize","textAlign","bgElement","find","e","created","window","getEditorApp","workId","$route","params","fetchWork","$message","error"],"mappings":"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","sourcesContent":["import { mapState, mapActions } from 'vuex'\r\nimport undoRedoHistory from '../../../store/plugins/undo-redo/History'\r\n\r\nimport '../styles/index.scss'\r\nimport 'animate.css'\r\n\r\nimport RenderEditCanvas from './canvas/edit'\r\nimport RenderPreviewCanvas from './canvas/preview'\r\nimport RenderPropsEditor from './edit-panel/props'\r\nimport RenderScriptEditor from './edit-panel/script'\r\nimport RenderAnimationEditor from './edit-panel/animation'\r\nimport RenderActoionEditor from './edit-panel/action'\r\nimport RenderBackgroundEditor from './edit-panel/background'\r\nimport RenderShortcutsPanel from './shortcuts-panel/index'\r\nimport RenderPageManager from './page-manager/index'\r\nimport PreviewDialog from './modals/preview.vue'\r\n\r\nimport LogoOfHeader from '@/components/common/header/logo.js'\r\nimport ExternalLinksOfHeader from '@/components/common/header/links.js'\r\nimport LangSelect from '@/components/common/header/LangSelect.vue'\r\nimport Feedback from '@/components/common/feedback/index'\r\n\r\n// const sidebarMenus = [\r\n//   {\r\n//     i18nLabel: 'editor.sidebar.components',\r\n//     label: '组件列表',\r\n//     value: 'pluginList',\r\n//     antIcon: 'bars'\r\n//   },\r\n//   {\r\n//     i18nLabel: 'editor.sidebar.pages',\r\n//     label: '页面管理',\r\n//     value: 'pageManagement',\r\n//     antIcon: 'snippets'\r\n//   },\r\n//   {\r\n//     i18nLabel: 'editor.sidebar.templates',\r\n//     label: '免费模板',\r\n//     value: 'freeTemplate',\r\n//     antIcon: 'appstore'\r\n//   }\r\n// ]\r\n\r\nconst fixedTools = [\r\n  {\r\n    i18nTooltip: 'editor.fixedTool.undo',\r\n    'tooltip': '撤消', // TODO 支持快捷键\r\n    'text': '撤消',\r\n    'icon': 'mail-reply',\r\n    'action': () => undoRedoHistory.undo()\r\n  },\r\n  {\r\n    i18nTooltip: 'editor.fixedTool.redo',\r\n    'tooltip': '恢复',\r\n    'text': '恢复',\r\n    'icon': 'mail-forward',\r\n    'action': () => undoRedoHistory.redo()\r\n  },\r\n  {\r\n    i18nTooltip: 'editor.fixedTool.preview',\r\n    'tooltip': '刷新预览',\r\n    'text': '刷新预览',\r\n    'icon': 'eye',\r\n    'action': function () { this.previewVisible = true }\r\n  },\r\n  // {\r\n  //   i18nTooltip: 'editor.fixedTool.copyCurrentPage',\r\n  //   'tooltip': '复制当前页',\r\n  //   'text': '复制当前页',\r\n  //   'icon': 'copy',\r\n  //   'action': function () { this.pageManager({ type: 'copy' }) }\r\n  // },\r\n  // {\r\n  //   i18nTooltip: 'editor.fixedTool.importPSD',\r\n  //   'tooltip': '导入PSD',\r\n  //   'text': 'Ps',\r\n  //   'icon': '',\r\n  //   'action': '',\r\n  //   'disabled': true\r\n  // },\r\n  {\r\n    i18nTooltip: 'editor.fixedTool.zoomOut',\r\n    'tooltip': '放大画布',\r\n    'text': '放大画布',\r\n    'icon': 'plus',\r\n    'action': function () { this.scaleRate += 0.25 }\r\n  },\r\n  {\r\n    i18nTooltip: 'editor.fixedTool.zoomIn',\r\n    'tooltip': '缩小画布',\r\n    'text': '缩小画布',\r\n    'icon': 'minus',\r\n    'action': function () { this.scaleRate -= 0.25 }\r\n  },\r\n  // {\r\n  //   i18nTooltip: 'editor.fixedTool.issues',\r\n  //   'tooltip': 'issues',\r\n  //   'text': '常见问题',\r\n  //   'icon': 'question',\r\n  //   'action': function () { window.open('https://github.com/ly525/luban-h5/issues/110') }\r\n  // }\r\n]\r\n\r\nexport default {\r\n  name: 'Editor',\r\n  components: {\r\n    LogoOfHeader,\r\n    ExternalLinksOfHeader,\r\n    LangSelect\r\n  },\r\n  data: () => ({\r\n    activeMenuKey: 'pluginList',\r\n    isPreviewMode: false,\r\n    activeTabKey: '属性',\r\n    previewVisible: false,\r\n    scaleRate: 1\r\n  }),\r\n  computed: {\r\n    ...mapState('editor', {\r\n      editingPage: state => state.editingPage,\r\n      editingElement: state => state.editingElement,\r\n      elements: state => state.editingPage.elements,\r\n      pages: state => state.work.pages,\r\n      work: state => state.work\r\n    }),\r\n    ...mapState('loading', [\r\n      'saveWork_loading',\r\n      'previewWork_loading',\r\n      'setWorkAsTemplate_loading',\r\n      'uploadWorkCover_loading'\r\n    ])\r\n  },\r\n  methods: {\r\n    ...mapActions('editor', [\r\n      'elementManager',\r\n      'pageManager',\r\n      'saveWork',\r\n      'createWork',\r\n      'fetchWork',\r\n      'setWorkAsTemplate',\r\n      'setEditingElement',\r\n      'setEditingPage'\r\n    ]),\r\n    ...mapActions('loading', {\r\n      updateLoading: 'update'\r\n    }),\r\n    /**\r\n     * !#zh 点击插件，copy 其基础数据到组件树（中间画布）\r\n     * #!en click the plugin shortcut, create new Element with the plugin's meta data\r\n     * pluginInfo {Object}: 插件列表中的基础数据, {name}=pluginInfo\r\n     */\r\n    clone ({ name }) {\r\n      this.elementManager({\r\n        type: 'add',\r\n        value: { name }\r\n      })\r\n    },\r\n    _renderMenuContent () {\r\n      return (\r\n        <a-tabs\r\n          style=\"height: 100%;\"\r\n          tabBarGutter={10}\r\n        >\r\n          <a-tab-pane key=\"plugin-list\" tab={this.$t('editor.sidebar.components')}>\r\n            <div class=\"plugin-usage-tip \">\r\n              <a-icon type=\"info-circle\" />\r\n              {/* <span class=\"ml-1\">使用提示: <strong>点击</strong>组件即可</span> */}\r\n              {/* Tip: just click on component */}\r\n              <i18n path=\"editor.tip.componentUsage\" tag=\"span\" class=\"ml-1\">\r\n                <strong>{ this.$t('editor.tip.click') }</strong>{ this.$t('editor.tip.click') }\r\n              </i18n>\r\n            </div>\r\n            <RenderShortcutsPanel pluginsList={this.pluginsList} handleClickShortcut={this.clone} />\r\n          </a-tab-pane>\r\n          <a-tab-pane key='page-manager' tab={this.$t('editor.sidebar.pages')}>\r\n            <RenderPageManager\r\n              pages={this.pages}\r\n              editingPage={this.editingPage}\r\n              onSelectMenuItem={(menuKey) => {\r\n                this.pageManager({ type: menuKey })\r\n              }}\r\n              onEditTitle={({ pageIndexForEditingTitle, newTitle }) => {\r\n                this.pageManager({ type: 'editTitle', value: { pageIndexForEditingTitle, newTitle } })\r\n                this.saveWork({ isSaveCover: false })\r\n              }}\r\n              onSelectPage={(pageIndex) => { this.setEditingPage(pageIndex) }}\r\n            />\r\n          </a-tab-pane>\r\n        </a-tabs>\r\n      )\r\n      // switch (this.activeMenuKey) {\r\n      //   case sidebarMenus[0].value:\r\n      //     return (\r\n      //       <a-tabs\r\n      //         style=\"height: 100%;\"\r\n      //         tabBarGutter={10}\r\n      //       >\r\n      //         <a-tab-pane key=\"plugin-list\" tab={this.$t('editor.sidebar.components')}>\r\n      //           <RenderShortcutsPanel pluginsList={this.pluginsList} handleClickShortcut={this.clone} />\r\n      //         </a-tab-pane>\r\n      //         <a-tab-pane key='page-manager' tab={this.$t('editor.sidebar.pages')}>\r\n      //           <RenderPageManager\r\n      //             pages={this.pages}\r\n      //             editingPage={this.editingPage}\r\n      //             onSelectMenuItem={(menuKey) => {\r\n      //               this.pageManager({ type: menuKey })\r\n      //             }}\r\n      //             onEditTitle={({ pageIndexForEditingTitle, newTitle }) => {\r\n      //               this.pageManager({ type: 'editTitle', value: { pageIndexForEditingTitle, newTitle } })\r\n      //               this.saveWork({ isSaveCover: false })\r\n      //             }}\r\n      //             onSelectPage={(pageIndex) => { this.setEditingPage(pageIndex) }}\r\n      //           />\r\n      //         </a-tab-pane>\r\n      //       </a-tabs>\r\n      //     )\r\n      //   case sidebarMenus[1].value:\r\n      //     return (\r\n      //       <RenderPageManager\r\n      //         pages={this.pages}\r\n      //         editingPage={this.editingPage}\r\n      //         onSelectMenuItem={(menuKey) => {\r\n      //           this.pageManager({ type: menuKey })\r\n      //         }}\r\n      //         onSelectPage={(pageIndex) => { this.setEditingPage(pageIndex) }}\r\n      //       />\r\n      //     )\r\n      //   default:\r\n      //     return null\r\n      // }\r\n    }\r\n  },\r\n  render (h) {\r\n    return (\r\n      <a-layout id=\"luban-editor-layout\" style={{ height: '100vh' }}>\r\n        <a-layout-header class=\"header\">\r\n          <LogoOfHeader />\r\n          <LangSelect style=\"float: right;cursor: pointer;\" />\r\n          {/* we can show the plugins shortcuts here */}\r\n          <a-menu\r\n            theme=\"dark\"\r\n            mode=\"horizontal\"\r\n            defaultSelectedKeys={['2']}\r\n            style={{ lineHeight: '64px', float: 'right', background: 'transparent' }}\r\n          >\r\n            {/* 保存、预览、发布、设置为模板 */}\r\n            <a-menu-item key=\"1\" class=\"transparent-bg\"><a-button type=\"primary\" size=\"small\" onClick={() => { this.saveWork({ loadingName: 'previewWork_loading' }).then(() => { this.previewVisible = true }) }} loading={this.previewWork_loading}>{this.$t('editor.header.preview')}</a-button></a-menu-item>\r\n            <a-menu-item key=\"2\" class=\"transparent-bg\"><a-button size=\"small\" onClick={() => this.saveWork({ isSaveCover: true })} loading={this.saveWork_loading || this.uploadWorkCover_loading}>{this.$t('editor.header.save')}</a-button></a-menu-item>\r\n            {/* <a-menu-item key=\"3\" class=\"transparent-bg\"><a-button size=\"small\">发布</a-button></a-menu-item> */}\r\n            <a-menu-item key=\"3\" class=\"transparent-bg\">\r\n              <a-dropdown-button onClick={() => {}} size=\"small\">\r\n                {/* 发布 */}\r\n                {this.$t('editor.header.publish')}\r\n                <a-menu slot=\"overlay\" onClick={({ key }) => {\r\n                  switch (key) {\r\n                    case 'setAsTemplate':\r\n                      this.updateLoading({ type: 'setWorkAsTemplate_loading', value: true })\r\n                      this.saveWork().then(() => {\r\n                        this.setWorkAsTemplate()\r\n                      })\r\n                  }\r\n                }}>\r\n                  <a-menu-item key=\"setAsTemplate\">\r\n                    <a-spin spinning={this.setWorkAsTemplate_loading} size=\"small\">\r\n                      {/* 设置为模板 */}\r\n                      <a-icon type=\"cloud-upload\" />{this.$t('editor.header.setAsTemplate')}\r\n                    </a-spin>\r\n                  </a-menu-item>\r\n                  {/* <a-menu-item key=\"2\"><a-icon type=\"user\" />2nd menu item</a-menu-item> */}\r\n                  {/* <a-menu-item key=\"3\"><a-icon type=\"user\" />3rd item</a-menu-item> */}\r\n                </a-menu>\r\n              </a-dropdown-button>\r\n            </a-menu-item>\r\n          </a-menu>\r\n          <ExternalLinksOfHeader />\r\n        </a-layout-header>\r\n        <a-layout>\r\n          {/* <a-layout-sider collapsedWidth={40} style=\"background: #fff\" collapsed>\r\n            <a-menu\r\n              mode=\"inline\"\r\n              defaultSelectedKeys={['pluginList']}\r\n              style={{ height: '100%', borderRight: 1 }}\r\n              onSelect={({ key }) => { this.activeMenuKey = key }}\r\n            >\r\n              {\r\n                sidebarMenus.map(menu => (\r\n                  <a-menu-item key={menu.value}>\r\n                    <a-icon type={menu.antIcon} />\r\n                    <span>{this.$t(menu.i18nLabel)}</span>\r\n                  </a-menu-item>\r\n                ))\r\n              }\r\n            </a-menu>\r\n          </a-layout-sider> */}\r\n          <a-layout-sider width=\"240\" theme='light' style={{ background: '#fff', padding: '12px' }}>\r\n            { this._renderMenuContent() }\r\n          </a-layout-sider>\r\n          <a-layout style=\"padding: 0 0 24px\">\r\n            <a-layout-content style={{ padding: '24px', margin: 0, minHeight: '280px' }}>\r\n              <div style=\"text-align: center;\">\r\n                <a-radio-group\r\n                  size=\"small\"\r\n                  value={this.isPreviewMode}\r\n                  onInput={isPreviewMode => {\r\n                    this.isPreviewMode = isPreviewMode\r\n                    if (isPreviewMode) {\r\n                      // 当切换到预览模式的时候，清空当前编辑元素\r\n                      this.setEditingElement() // 相当于  setEditingElement(null)\r\n                    }\r\n                  }}\r\n                >\r\n                  {/* 编辑模式、预览模式 */}\r\n                  <a-radio-button label={false} value={false}>{this.$t('editor.centerPanel.mode.edit')}</a-radio-button>\r\n                  <a-radio-button label={true} value={true}>{this.$t('editor.centerPanel.mode.preview')}</a-radio-button>\r\n                </a-radio-group>\r\n              </div>\r\n              <div class='canvas-wrapper' style={{ transform: `scale(${this.scaleRate})` }}>\r\n                {/* { this.isPreviewMode ? this.renderPreview(h, this.elements) : this.renderCanvas(h, this.elements) } */}\r\n                { this.isPreviewMode\r\n                  ? <RenderPreviewCanvas elements={this.elements}/>\r\n                  : <RenderEditCanvas\r\n                    class=\"edit-mode\"\r\n                    elements={this.elements}\r\n                  />\r\n                }\r\n              </div>\r\n            </a-layout-content>\r\n          </a-layout>\r\n          <a-layout-sider width=\"40\" theme='light' style={{ background: '#fff', border: '1px solid #eee' }}>\r\n            {/* <div>\r\n              <a-button shape=\"circle\" icon=\"search\" type=\"link\" />\r\n            </div> */}\r\n            <a-button-group style={{ display: 'flex', flexDirection: 'column' }}>\r\n              {\r\n                fixedTools.map(tool => (\r\n                  // <a-tooltip effect=\"dark\" placement=\"left\" title={tool.tooltip}>\r\n                  <a-tooltip effect=\"dark\" placement=\"left\" title={this.$t(tool.i18nTooltip)}>\r\n                    <a-button block class=\"transparent-bg\" type=\"link\" size=\"small\" style={{ height: '40px', color: '#000' }} onClick={() => tool.action && tool.action.call(this) } disabled={!!tool.disabled}>\r\n                      { tool.icon ? <i class={['shortcut-icon', 'fa', `fa-${tool.icon}`]} aria-hidden='true'/> : tool.text }\r\n                    </a-button>\r\n                    { tool.icon === 'minus' && <div style={{ fontSize: '12px', textAlign: 'center' }}>{this.scaleRate * 100}%</div> }\r\n                  </a-tooltip>\r\n                ))\r\n              }\r\n            </a-button-group>\r\n          </a-layout-sider>\r\n          <a-layout-sider width=\"300\" theme='light' style={{ background: '#fff', padding: '0 12px' }}>\r\n            <a-tabs\r\n              style=\"height: 100%;\"\r\n              tabBarGutter={10}\r\n              onChange={activeTabKey => {\r\n                this.activeTabKey = activeTabKey\r\n                if (activeTabKey === 'background') {\r\n                  const bgElement = this.elements.find(e => e.name === 'lbp-background')\r\n                  this.setEditingElement(bgElement)\r\n                }\r\n              }}\r\n            >\r\n              {/*\r\n                #!zh tab 标题：\r\n                #!en tab title\r\n                  ElementUI：label\r\n                  Ant Design Vue：tab\r\n              */}\r\n              <a-tab-pane key=\"属性\"><span slot=\"tab\">{this.$t('editor.editPanel.tab.prop')}</span><RenderPropsEditor/></a-tab-pane>\r\n              <a-tab-pane label=\"动画\" key='动画' tab={this.$t('editor.editPanel.tab.animation')}><RenderAnimationEditor /></a-tab-pane>\r\n              <a-tab-pane label=\"动作\" key='动作' tab={this.$t('editor.editPanel.tab.action')}>{ this.activeTabKey === '动作' && <RenderActoionEditor/> }</a-tab-pane>\r\n              <a-tab-pane label=\"脚本\" key='脚本' tab={this.$t('editor.editPanel.tab.script')}><RenderScriptEditor/></a-tab-pane>\r\n              <a-tab-pane label=\"背景\" key='background' tab={this.$t('editor.editPanel.tab.background')}><RenderBackgroundEditor/></a-tab-pane>\r\n            </a-tabs>\r\n          </a-layout-sider>\r\n\r\n        </a-layout>\r\n        {\r\n          <PreviewDialog\r\n            work={this.work}\r\n            visible={this.previewVisible}\r\n            handleClose={() => { this.previewVisible = false }}\r\n          />\r\n        }\r\n        <Feedback />\r\n      </a-layout>\r\n    )\r\n  },\r\n  created () {\r\n    // event bus for editor\r\n    window.getEditorApp = this\r\n    let workId = this.$route.params.workId\r\n    if (workId) {\r\n      this.fetchWork(workId)\r\n    } else {\r\n      this.$message.error('no work id!')\r\n    }\r\n  }\r\n}"]}]}