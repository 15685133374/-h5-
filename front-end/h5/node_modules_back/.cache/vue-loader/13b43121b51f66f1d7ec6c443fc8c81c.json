{"remainingRequest":"D:\\project\\luban\\luban-h5\\front-end\\h5\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\project\\luban\\luban-h5\\front-end\\h5\\src\\components\\core\\editor\\modals\\preview.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\project\\luban\\luban-h5\\front-end\\h5\\src\\components\\core\\editor\\modals\\preview.vue","mtime":1575526862182},{"path":"D:\\project\\luban\\luban-h5\\front-end\\h5\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1575454486584},{"path":"D:\\project\\luban\\luban-h5\\front-end\\h5\\node_modules\\babel-loader\\lib\\index.js","mtime":1575361257763},{"path":"D:\\project\\luban\\luban-h5\\front-end\\h5\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1575454486584},{"path":"D:\\project\\luban\\luban-h5\\front-end\\h5\\node_modules\\vue-loader\\lib\\index.js","mtime":1575454488300}],"contextDependencies":[],"result":["\r\nimport { mapActions } from 'vuex'\r\nimport QRCode from 'qrcode'\r\n\r\nexport default {\r\n  props: {\r\n    visible: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    handleClose: {\r\n      type: Function,\r\n      default: () => {}\r\n    },\r\n    work: {\r\n      type: Object,\r\n      default: () => {}\r\n    }\r\n  },\r\n  computed: {\r\n    // ...mapState('editor', {\r\n    //   work: state => state.work\r\n    // }),\r\n    releaseUrl () {\r\n      return `/works/preview/${this.work.id}`\r\n    }\r\n  },\r\n  data () {\r\n    return {\r\n      confirmLoading: false,\r\n      qrcodeSize: 500\r\n    }\r\n  },\r\n  watch: {\r\n    visible (val) {\r\n      if (!val) return\r\n      this.$nextTick(() => this.drawQRcode())\r\n    }\r\n  },\r\n  methods: {\r\n    ...mapActions('editor', [\r\n      'saveWork',\r\n      'updateWork'\r\n    ]),\r\n    handleOk (e) {\r\n      this.confirmLoading = true\r\n      this.saveWork().then(res => {\r\n        this.handleClose()\r\n        this.confirmLoading = false\r\n      })\r\n      // setTimeout(() => {\r\n      // }, 2000);\r\n    },\r\n    handleCancel (e) {\r\n      console.log('Clicked cancel button')\r\n      this.handleClose()\r\n    },\r\n    drawQRcode () {\r\n      var canvas = document.getElementById('qrcode-container')\r\n      QRCode.toCanvas(canvas, this.releaseUrl, { scale: 4 }, err => {\r\n        console.log(err)\r\n      })\r\n    },\r\n    postMessage2Iframe (message) {\r\n      let iframeWin = document.getElementById('iframe-for-preview').contentWindow\r\n      iframeWin.postMessage(message, window.location.origin)\r\n    },\r\n    openNewTab (urlType) {\r\n      switch (urlType) {\r\n        case 'previewDebug':\r\n          window.open(this.releaseUrl)\r\n          break\r\n        case 'buildEngineDocs':\r\n          window.open('https://ly525.github.io/luban-h5/zh/getting-started/quick-start.html#_2-%E6%9E%84%E5%BB%BA%E9%A2%84%E8%A7%88%E6%89%80%E9%9C%80%E7%9A%84%E6%B8%B2%E6%9F%93%E5%BC%95%E6%93%8E')\r\n          break\r\n      }\r\n    }\r\n  },\r\n  render (h) {\r\n    return (\r\n      <a-modal\r\n        visible={this.visible}\r\n        confirmLoading={this.confirmLoading}\r\n        onOk={this.handleOk}\r\n        onCancel={this.handleCancel}\r\n        width=\"70%\"\r\n        okText=\"保存\"\r\n      >\r\n        <div class=\"preview-wrapper\">\r\n          <a-row gutter={20}>\r\n            <a-col span={8}>\r\n              <div class=\"phone-wrapper\" style={{ transform: 'scale(0.8)' }}>\r\n                <div class=\"phone\">\r\n                  <div class=\"float-ctrl-panel\">\r\n                    <a class=\"page-controller\" onClick={(e) => { this.postMessage2Iframe('prev') }}>上一页</a>\r\n                    <a class=\"page-controller\" onClick={(e) => { this.postMessage2Iframe('next') }}>下一页</a>\r\n                    {/**\r\n                    <a-button icon=\"up\" shape=\"circle\" onClick={() => { this.postMessage2Iframe('prev') }}></a-button>\r\n                    <a-button icon=\"down\" shape=\"circle\" onClick={() => { this.postMessage2Iframe('next') }}></a-button>\r\n                    <a-icon type=\"up\" class=\"page-controller\" onClick={() => { this.postMessage2Iframe('prev') }}/>\r\n                    <a-icon type=\"down\" class=\"page-controller\"  onClick={() => { this.postMessage2Iframe('next') }}/>\r\n                    */}\r\n                  </div>\r\n                  <iframe\r\n                    id=\"iframe-for-preview\"\r\n                    src={this.releaseUrl}\r\n                    frameborder=\"0\"\r\n                    style=\"height: 100%;width: 100%;\"\r\n                  ></iframe>\r\n                  {/** <engine :work=\"editingWork\" :map-config=\"{}\" /> */}\r\n                </div>\r\n              </div>\r\n            </a-col>\r\n            <a-col span={12} offset={4}>\r\n              <div class=\"setting\">\r\n                <div class=\"info\">\r\n                  <h4 class=\"label\">设置作品信息</h4>\r\n                  <a-input\r\n                    class=\"input\"\r\n                    value={this.work.title}\r\n                    onChange={e => this.updateWork({ title: e.target.value })}\r\n                    // onBlur={this.saveTitle}\r\n                    placeholder=\"请输入标题\"\r\n                  ></a-input>\r\n                  <a-input\r\n                    class=\"input\"\r\n                    value={this.work.description}\r\n                    onChange={e => this.updateWork({ description: e.target.value })}\r\n                    // v-model=\"description\"\r\n                    // onBlur={this.saveDescription}\r\n                    placeholder=\"请输入描述\"\r\n                    type=\"textarea\"\r\n                  ></a-input>\r\n                </div>\r\n                <div class=\"qrcode my-4\">\r\n                  <div class=\"label\">\r\n                    <span>手机扫码分享给好友</span>\r\n                  </div>\r\n                  <div class=\"code\">\r\n                    <canvas style=\"float: left\" id=\"qrcode-container\"></canvas>\r\n                    {/**\r\n                    <a-radio-group class=\"radios\" value={this.qrcodeSize} onChange={e => { this.qrcodeSize = e.target.value }}>\r\n                      <a-radio label={500} value={500}>500x500</a-radio>\r\n                      <a-radio label={1000} value={1000}>1000x1000</a-radio>\r\n                      <a-radio label={2000} value={2000}>2000x2000</a-radio>\r\n                    </a-radio-group>\r\n                    */}\r\n                  </div>\r\n                </div>\r\n                <div style=\"background: #fafafa;\">\r\n                  <a-button type=\"link\" icon=\"link\" onClick={() => this.openNewTab('previewDebug')}>打开预览 URL(For Debug) </a-button>\r\n                  <a-button type=\"link\" icon=\"link\" onClick={() => this.openNewTab('buildEngineDocs')}>如果本地预览显示空白，点此查看文档</a-button>\r\n                </div>\r\n              </div>\r\n            </a-col>\r\n          </a-row>\r\n        </div>\r\n      </a-modal>\r\n    )\r\n  }\r\n}\r\n",{"version":3,"sources":["preview.vue"],"names":[],"mappings":";AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"preview.vue","sourceRoot":"src/components/core/editor/modals","sourcesContent":["<script>\r\nimport { mapActions } from 'vuex'\r\nimport QRCode from 'qrcode'\r\n\r\nexport default {\r\n  props: {\r\n    visible: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    handleClose: {\r\n      type: Function,\r\n      default: () => {}\r\n    },\r\n    work: {\r\n      type: Object,\r\n      default: () => {}\r\n    }\r\n  },\r\n  computed: {\r\n    // ...mapState('editor', {\r\n    //   work: state => state.work\r\n    // }),\r\n    releaseUrl () {\r\n      return `/works/preview/${this.work.id}`\r\n    }\r\n  },\r\n  data () {\r\n    return {\r\n      confirmLoading: false,\r\n      qrcodeSize: 500\r\n    }\r\n  },\r\n  watch: {\r\n    visible (val) {\r\n      if (!val) return\r\n      this.$nextTick(() => this.drawQRcode())\r\n    }\r\n  },\r\n  methods: {\r\n    ...mapActions('editor', [\r\n      'saveWork',\r\n      'updateWork'\r\n    ]),\r\n    handleOk (e) {\r\n      this.confirmLoading = true\r\n      this.saveWork().then(res => {\r\n        this.handleClose()\r\n        this.confirmLoading = false\r\n      })\r\n      // setTimeout(() => {\r\n      // }, 2000);\r\n    },\r\n    handleCancel (e) {\r\n      console.log('Clicked cancel button')\r\n      this.handleClose()\r\n    },\r\n    drawQRcode () {\r\n      var canvas = document.getElementById('qrcode-container')\r\n      QRCode.toCanvas(canvas, this.releaseUrl, { scale: 4 }, err => {\r\n        console.log(err)\r\n      })\r\n    },\r\n    postMessage2Iframe (message) {\r\n      let iframeWin = document.getElementById('iframe-for-preview').contentWindow\r\n      iframeWin.postMessage(message, window.location.origin)\r\n    },\r\n    openNewTab (urlType) {\r\n      switch (urlType) {\r\n        case 'previewDebug':\r\n          window.open(this.releaseUrl)\r\n          break\r\n        case 'buildEngineDocs':\r\n          window.open('https://ly525.github.io/luban-h5/zh/getting-started/quick-start.html#_2-%E6%9E%84%E5%BB%BA%E9%A2%84%E8%A7%88%E6%89%80%E9%9C%80%E7%9A%84%E6%B8%B2%E6%9F%93%E5%BC%95%E6%93%8E')\r\n          break\r\n      }\r\n    }\r\n  },\r\n  render (h) {\r\n    return (\r\n      <a-modal\r\n        visible={this.visible}\r\n        confirmLoading={this.confirmLoading}\r\n        onOk={this.handleOk}\r\n        onCancel={this.handleCancel}\r\n        width=\"70%\"\r\n        okText=\"保存\"\r\n      >\r\n        <div class=\"preview-wrapper\">\r\n          <a-row gutter={20}>\r\n            <a-col span={8}>\r\n              <div class=\"phone-wrapper\" style={{ transform: 'scale(0.8)' }}>\r\n                <div class=\"phone\">\r\n                  <div class=\"float-ctrl-panel\">\r\n                    <a class=\"page-controller\" onClick={(e) => { this.postMessage2Iframe('prev') }}>上一页</a>\r\n                    <a class=\"page-controller\" onClick={(e) => { this.postMessage2Iframe('next') }}>下一页</a>\r\n                    {/**\r\n                    <a-button icon=\"up\" shape=\"circle\" onClick={() => { this.postMessage2Iframe('prev') }}></a-button>\r\n                    <a-button icon=\"down\" shape=\"circle\" onClick={() => { this.postMessage2Iframe('next') }}></a-button>\r\n                    <a-icon type=\"up\" class=\"page-controller\" onClick={() => { this.postMessage2Iframe('prev') }}/>\r\n                    <a-icon type=\"down\" class=\"page-controller\"  onClick={() => { this.postMessage2Iframe('next') }}/>\r\n                    */}\r\n                  </div>\r\n                  <iframe\r\n                    id=\"iframe-for-preview\"\r\n                    src={this.releaseUrl}\r\n                    frameborder=\"0\"\r\n                    style=\"height: 100%;width: 100%;\"\r\n                  ></iframe>\r\n                  {/** <engine :work=\"editingWork\" :map-config=\"{}\" /> */}\r\n                </div>\r\n              </div>\r\n            </a-col>\r\n            <a-col span={12} offset={4}>\r\n              <div class=\"setting\">\r\n                <div class=\"info\">\r\n                  <h4 class=\"label\">设置作品信息</h4>\r\n                  <a-input\r\n                    class=\"input\"\r\n                    value={this.work.title}\r\n                    onChange={e => this.updateWork({ title: e.target.value })}\r\n                    // onBlur={this.saveTitle}\r\n                    placeholder=\"请输入标题\"\r\n                  ></a-input>\r\n                  <a-input\r\n                    class=\"input\"\r\n                    value={this.work.description}\r\n                    onChange={e => this.updateWork({ description: e.target.value })}\r\n                    // v-model=\"description\"\r\n                    // onBlur={this.saveDescription}\r\n                    placeholder=\"请输入描述\"\r\n                    type=\"textarea\"\r\n                  ></a-input>\r\n                </div>\r\n                <div class=\"qrcode my-4\">\r\n                  <div class=\"label\">\r\n                    <span>手机扫码分享给好友</span>\r\n                  </div>\r\n                  <div class=\"code\">\r\n                    <canvas style=\"float: left\" id=\"qrcode-container\"></canvas>\r\n                    {/**\r\n                    <a-radio-group class=\"radios\" value={this.qrcodeSize} onChange={e => { this.qrcodeSize = e.target.value }}>\r\n                      <a-radio label={500} value={500}>500x500</a-radio>\r\n                      <a-radio label={1000} value={1000}>1000x1000</a-radio>\r\n                      <a-radio label={2000} value={2000}>2000x2000</a-radio>\r\n                    </a-radio-group>\r\n                    */}\r\n                  </div>\r\n                </div>\r\n                <div style=\"background: #fafafa;\">\r\n                  <a-button type=\"link\" icon=\"link\" onClick={() => this.openNewTab('previewDebug')}>打开预览 URL(For Debug) </a-button>\r\n                  <a-button type=\"link\" icon=\"link\" onClick={() => this.openNewTab('buildEngineDocs')}>如果本地预览显示空白，点此查看文档</a-button>\r\n                </div>\r\n              </div>\r\n            </a-col>\r\n          </a-row>\r\n        </div>\r\n      </a-modal>\r\n    )\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.preview-wrapper {\r\n  position: relative;\r\n  min-height: 480px;\r\n\r\n  .phone-wrapper {\r\n    position: absolute;\r\n    box-sizing: content-box;\r\n    .phone {\r\n      position: absolute;\r\n      width: 320px;\r\n      height: 568px;\r\n\r\n      display: inline-block;\r\n      background: #fff;\r\n      box-sizing: content-box;\r\n      border-top: 10px solid #f6f6f6;\r\n      border-left: 10px solid #f6f6f6;\r\n      border-right: 10px solid #f6f6f6;\r\n      border-bottom: 20px solid #f6f6f6;\r\n      border-radius: 20px;\r\n      -webkit-transform-origin: 100% 0;\r\n      transform-origin: 100% 0;\r\n      -webkit-transform: scale(1);\r\n      transform: scale(1);\r\n\r\n      .float-ctrl-panel {\r\n        position: absolute;\r\n        top: 100px;\r\n        right: -40px;\r\n\r\n        .page-controller {\r\n          display: block;\r\n          cursor: pointer;\r\n          width: 30px;\r\n          height: 80px;\r\n          border-top-right-radius: 5px;\r\n          border-bottom-right-radius: 5px;\r\n          background: #2096f9;\r\n          font-size: 12px;\r\n          text-align: center;\r\n          border: 1px solid #2096f9;\r\n          color: #fff;\r\n          // position: absolute;\r\n          padding: 14px 8px;\r\n          margin-top: 12px;\r\n          // margin-top: -50px;\r\n        }\r\n\r\n      }\r\n    }\r\n  }\r\n  .setting {\r\n    color: #4a4a4a;\r\n    font-size: 14px;\r\n    float: right;\r\n    width: 380px;\r\n    .info {\r\n      .input {\r\n        margin-top: 10px;\r\n      }\r\n    }\r\n    .qrcode {\r\n      margin-top: 20px;\r\n\r\n      .label span {\r\n        margin-right: 10px;\r\n      }\r\n    }\r\n    .code {\r\n      // !#zh 防止浮动塌陷\r\n      overflow: hidden;\r\n      .radios {\r\n        width: 80px;\r\n        margin-top: 5px;\r\n        margin-left: 30px;\r\n        label {\r\n          margin-left: 0px;\r\n          margin-top: 10px;\r\n        }\r\n        button {\r\n          margin-top: 15px;\r\n        }\r\n      }\r\n    }\r\n    .link {\r\n      width: 100%;\r\n      display: block;\r\n    }\r\n    .edit {\r\n      text-align: center;\r\n      margin-top: 20px;\r\n    }\r\n  }\r\n}\r\n\r\n</style>\r\n"]}]}