{"remainingRequest":"d:\\project\\luban\\luban-h5\\front-end\\h5\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!d:\\project\\luban\\luban-h5\\front-end\\h5\\src\\views\\work-manager\\form-stat\\detail.vue?vue&type=script&lang=js&","dependencies":[{"path":"d:\\project\\luban\\luban-h5\\front-end\\h5\\src\\views\\work-manager\\form-stat\\detail.vue","mtime":1575526862462},{"path":"d:\\project\\luban\\luban-h5\\front-end\\h5\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1575454486584},{"path":"d:\\project\\luban\\luban-h5\\front-end\\h5\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1575454488217},{"path":"d:\\project\\luban\\luban-h5\\front-end\\h5\\node_modules\\babel-loader\\lib\\index.js","mtime":1575361257763},{"path":"d:\\project\\luban\\luban-h5\\front-end\\h5\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1575454486584},{"path":"d:\\project\\luban\\luban-h5\\front-end\\h5\\node_modules\\vue-loader\\lib\\index.js","mtime":1575454488300}],"contextDependencies":[],"result":["\r\n/**\r\n * [基础数据](/work-manager/form-stat) 对应的页面\r\n *\r\n */\r\nimport { mapState, mapActions } from 'vuex'\r\n\r\nexport default {\r\n  components: {\r\n  },\r\n  data: () => ({\r\n    activeWork: null,\r\n    previewVisible: false\r\n  }),\r\n  computed: {\r\n    ...mapState('editor', ['works', 'formDetailOfWork']),\r\n    computedWorks () {\r\n      return this.works.map(w => ({\r\n        id: w.id,\r\n        title: w.title,\r\n        pv: w.pv || 0,\r\n        uv: w.uv || 0,\r\n        formCount: w.formCount || 0\r\n      }))\r\n    },\r\n    /**\r\n     * columns demo: [{\"1565369322603\":\"abc\"},{\"1565595388440\":\"ddd\"},{\"1565595388440\":\"acd\"},{\"1565596393441\":\"b\",\"1565596397671\":\"a\"},{\"1565596393441\":\"b\",\"1565596397671\":\"a\"}]\r\n     */\r\n    columns () {\r\n      const { uuidMap2Name } = this.formDetailOfWork\r\n      // the uuid for input plugin\r\n      return Object.entries(uuidMap2Name).map(([uuid, inputName]) => ({\r\n        title: inputName,\r\n        key: `uuid-${uuid}`,\r\n        dataIndex: `uuid-${uuid}`\r\n      }))\r\n    },\r\n    /**\r\n     * rows demo: [{\"title\":\"姓名\",\"key\":\"1565596393441\"},{\"title\":\"学校\",\"key\":\"1565596397671\"}]\r\n     *\r\n     * formRecords example: <[{\r\n        \"id\": 4,\r\n        \"form\": {\r\n          \"1565595388440\": \"ddd\",\r\n          1234: 'abc'\r\n        },\r\n        \"work\": 8,\r\n        \"created_at\": \"2019-08-11T07:36:54.521Z\",\r\n        \"updated_at\": \"2019-08-11T07:36:54.526Z\"\r\n      }]>\r\n    */\r\n    rows () {\r\n      const { formRecords, uuidMap2Name } = this.formDetailOfWork\r\n      const rows = formRecords.map(({ form, id }) => {\r\n        const row = {}\r\n        Object.entries(form).forEach(([uuid, inputValue = '-']) => {\r\n          if (uuidMap2Name[uuid]) {\r\n            row[`uuid-${uuid}`] = inputValue\r\n            row.id = id\r\n          }\r\n        })\r\n        return row\r\n      })\r\n      return rows.filter(row => Object.keys(row).length)\r\n    }\r\n  },\r\n  methods: {\r\n    ...mapActions('editor', [\r\n      'fetchWorks',\r\n      'fetchFormsOfWork'\r\n    ]),\r\n    deleteWork (item) {\r\n      // TODO delete work from work list\r\n    },\r\n    createWork () {\r\n      this.$router.push({ name: 'editor' })\r\n    }\r\n  },\r\n  render (h) {\r\n    return (\r\n      <div class=\"works-wrapper\">\r\n        <a-table columns={this.columns} dataSource={this.rows} row-key=\"id\" scopedSlots={{\r\n          action: function (props) {\r\n            // 查看数据\r\n            return [<router-link to={{ name: 'stat-detail', params: { id: props.id } }} >{this.$t('basicData.viewData')}</router-link>]\r\n          }\r\n        }}>\r\n        </a-table>\r\n      </div>\r\n    )\r\n  },\r\n  created () {\r\n    // this.fetchWorks()\r\n    const workId = this.$route.params.id\r\n    this.fetchFormsOfWork(workId)\r\n  }\r\n}\r\n",null]}